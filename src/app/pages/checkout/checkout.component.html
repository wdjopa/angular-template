<app-breadcrumb [title]="'Caisse'" [breadcrumbs]='breadcrumbs' [end_breadcrumb]="'Passage à la caisse'">
</app-breadcrumb>

<!-- Shopping Cart Section Begin -->
<section class="shopping-cart spad"
  *ngIf="cart && cart.produitCommandes && cart.produitCommandes.length <= 0 && company != undefined ">
  <div class="container">
    <div class="row">
      <div class="col-lg-8">
        Votre panier est vide pour l'instant.
        <br>
      </div>
      <div class="col-lg-4">
        <div class="continue__btn">
          <a [routerLink]="['/catalogue']">Continuer mes achats</a>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="shopping-cart spad"
  *ngIf="show">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="shopping__cart__table">
          <form #f="ngForm" (ngSubmit)="makeAnOrder(f)">
            <div class="row">
              <div class="col-md-4">
                <h6 class="checkout__title">Mode de paiement</h6>
                <h6 >Sélectionnez un mode paiement pour votre commande.</h6>
                <span *ngIf="err.payment" class="text-accent">Veuillez faire un choix pour le mode de paiement</span>
                <div class="row">
                  <div class="col-lg-12">
                    <div class="checkout__input d-flex justify-content-start w-100" style="flex-wrap: wrap;">
                      <!-- <div class="paymentModeLogo pointer" (click)="selectPaymentMode('cash')"
                        [ngClass]="{'active': payment.mode === 'cash'}">
                        <img src="assets/img/cash.png" alt="Cash" class="" />
                        Espèces
                      </div> -->
                      <div class="paymentModeLogo pointer" (click)="selectPaymentMode(paymentMode.id)"
                        *ngFor="let paymentMode of paymentModes"
                        [ngClass]="{'active': payment.mode === paymentMode.id}">
                        <img [src]="'assets/img/'+paymentMode.id+'.png'" [alt]="paymentMode.id" />
                        {{paymentMode.name}}
                      </div>

                    </div>
                  </div>
                  <div class="col-lg-12 mt-2">
                    <h4 class="text-dark  border-top pt-4">Total : <span class="text-accent">
                        {{cart.total | number: '1.0-0'}}
                        {{company?.devise?.symbol}}</span></h4>
                  </div>
                </div>
                <br>
                <br>
              </div>
              <div class="col-md-8">

                <h6 class="checkout__title">Adresse de livraison</h6>
                <h6 *ngIf="shippingAddresses.length > 0">Sélectionnez une adresse de livraison parmi vos adresses.</h6>
                <h6 *ngIf="shippingAddresses.length == 0">Ajoutez une adresse de livraison.</h6>
                <span *ngIf="err.payment" class="text-accent">Veuillez faire un choix pour l'adresse de livraison</span>

                <div class="row">

                  <div class="col-12">

                    <div class="bg-white p-3 mt-3 border select_address"
                      [ngClass]="{'active': address.id===shippingAddress.id}" (click)="selectAddress(address)"
                      *ngFor='let address of shippingAddresses'>
                      <h4>{{address.label}}</h4>
                      <div class="p-2">
                        {{address.given_name}}
                        {{address.family_name}}
                        <br>
                        {{address.attributes.tel}}
                        <br>

                        {{address.street}},
                        {{address.city}} {{address.postal}},
                        {{address.country}}
                      </div>
                      <br>
                    </div>
                    <a [routerLink]="['/compte/adresses/add']"  [queryParams]="{from: 'caisse'}">
                      <div class="bg-white p-3 mt-3 border text-accent text-center pointer">
                        Ajouter une nouvelle adresse
                      </div>
                    </a>
                  </div>
                </div>

                <!-- <h6 class="alert-danger text-accent alert" *ngIf="err.message">{{err.message}}</h6>
                <div class="row">
                  <div class="col-lg-6">
                    <div class="checkout__input">
                      <p>Prénom<span></span></p>
                      <input ngModel name="prenom" type="text" placeholder="Votre prénom">
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="checkout__input">
                      <p>Nom<span>*</span></p>
                      <input ngModel name="nom" type="text" placeholder="Votre nom">
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                    <div class="checkout__input">
                      <p>Numéro de Tél<span>*</span></p>
                      <small>Avec indicatif</small>
                      <input ngModel name="tel" type="tel" placeholder="Ex : +237 6 55 55 55 44 ">
                    </div>
                  </div>
                </div>
                <div class="checkout__input">
                  <p>Country<span>*</span></p>
                  <input type="text">
                </div>
                <div class="checkout__input">
                  <p>Address<span>*</span></p>
                  <input type="text" placeholder="Street Address" class="checkout__input__add">
                  <input type="text" placeholder="Apartment, suite, unite ect (optinal)">
                </div>
                <div class="checkout__input">
                  <p>Town/City<span>*</span></p>
                  <input type="text">
                </div>
                <div class="checkout__input">
                  <p>Country/State<span>*</span></p>
                  <input type="text">
                </div>
                <div class="checkout__input">
                  <p>Postcode / ZIP<span>*</span></p>
                  <input type="text">
                </div>
                <div class="checkout__input__checkbox">
                  <label for="diff-acc">
                    Note about your order, e.g, special noe for delivery
                    <input type="checkbox" id="diff-acc">
                    <span class="checkmark"></span>
                  </label>
                </div> -->
                <br>
                <br>
                <h6 class="checkout__title mt-4">Notes de commande</h6>
                <div class="checkout__input">
                  <textarea name="note" placeholder="Notes par rapport à cette commande" ngModel rows="5"></textarea>
                  <!-- <input type="text" placeholder="Notes about your order, e.g. special notes for delivery."> -->
                </div>
                <div class="checkout__input text-right">
                  <button type="submit" class="btn primary-btn text-light" [disabled]="loading" >FINALISER MA COMMANDE</button>
                </div>
              </div>
            </div>
          </form>
        </div>

      </div>
      <div class="col-lg-4 d-none">
        <div class="cart__total">
          <h6>Récapitulatif</h6>
          <ul>
            <li>Sous-total <span class="text-dark">{{cart.subtotal| number: '1.0-0'}}
                {{company.devise.symbol}}</span></li>
            <li *ngIf="cart.discount">Réduction
              {{cart.discount.mesure === "pourcentage" ? '('+cart.discount.value.split(".")[0]+'%)': ''}} <span
                class="text-accent">-{{cart.discount.discount_value | number: '1.0-0'}}
                {{company.devise.symbol}}</span></li>
            <li>Livraison <span class="text-dark"
                *ngIf="company.tarif_livraison">{{company.tarif_livraison | number: '1.0-0'}}
                {{company.devise.symbol}}</span>
              <span class="text-accent" *ngIf="!company.tarif_livraison">OFFERTE</span>
            </li>
            <li><br></li>
            <li>
              <h4 class="text-dark">Total</h4>
              <span class="text-accent">{{cart.total | number: '1.0-0'}} {{company.devise.symbol}}</span>
            </li>
          </ul>
          <a [routerLink]="['/caisse']" class="primary-btn">Commander</a>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Shopping Cart Section End -->
